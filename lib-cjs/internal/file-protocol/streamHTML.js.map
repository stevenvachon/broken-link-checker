{"version":3,"file":"streamHTML.js","names":["_fs","require","_errors","_path","_errors2","FILE_EXTENSIONS","ERROR_EVENT","OPEN_EVENT","_default","url","Promise","resolve","reject","pathFileExtension","extname","pathname","some","ext","ExpectedHTMLExtensionError","stream","createReadStream","on","code","HTMLRetrievalError","exports","default","module"],"sources":["../../../lib/internal/file-protocol/streamHTML.js"],"sourcesContent":["import {createReadStream} from \"fs\";\nimport {ExpectedHTMLExtensionError} from \"./errors\";\nimport {extname} from \"path\";\nimport {HTMLRetrievalError} from \"../errors\";\n\n\n\nconst FILE_EXTENSIONS = [\".htm\", \".html\", \".xht\", \".xhtml\"];\n\nconst ERROR_EVENT = \"error\";\nconst OPEN_EVENT = \"open\";\n\n\n\n/**\n * Read a file URL for its HTML contents.\n * @param {URL} url\n * @throws {ExpectedHTMLExtensionError} if not HTML media type\n * @throws {HTMLRetrievalError} file not found, etc\n * @returns {Promise<Stream>}\n * @todo return {response, stream} structure to be consistent with HTTP, and thereby support other protocols?\n */\nexport default url => new Promise((resolve, reject) =>\n{\n\tconst pathFileExtension = extname(url.pathname);\n\n\tif (!FILE_EXTENSIONS.some(ext => pathFileExtension === ext))\n\t{\n\t\tthrow new ExpectedHTMLExtensionError(pathFileExtension);\n\t}\n\telse\n\t{\n\t\tconst stream = createReadStream(url);\n\n\t\tstream.on(ERROR_EVENT, ({code}) => reject(new HTMLRetrievalError(code)));\n\t\tstream.on(OPEN_EVENT, () => resolve(stream));\n\t}\n});\n"],"mappings":";;;;;;AAAA,IAAAA,GAAA,GAAAC,OAAA;AACA,IAAAC,OAAA,GAAAD,OAAA;AACA,IAAAE,KAAA,GAAAF,OAAA;AACA,IAAAG,QAAA,GAAAH,OAAA;AAIA,MAAMI,eAAe,GAAG,CAAC,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,CAAC;AAE3D,MAAMC,WAAW,GAAG,OAAO;AAC3B,MAAMC,UAAU,GAAG,MAAM;;AAIzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA,IAAAC,QAAA,GAQeC,GAAG,IAAI,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAClD;EACC,MAAMC,iBAAiB,GAAG,IAAAC,aAAO,EAACL,GAAG,CAACM,QAAQ,CAAC;EAE/C,IAAI,CAACV,eAAe,CAACW,IAAI,CAACC,GAAG,IAAIJ,iBAAiB,KAAKI,GAAG,CAAC,EAC3D;IACC,MAAM,IAAIC,kCAA0B,CAACL,iBAAiB,CAAC;EACxD,CAAC,MAED;IACC,MAAMM,MAAM,GAAG,IAAAC,oBAAgB,EAACX,GAAG,CAAC;IAEpCU,MAAM,CAACE,EAAE,CAACf,WAAW,EAAE,CAAC;MAACgB;IAAI,CAAC,KAAKV,MAAM,CAAC,IAAIW,2BAAkB,CAACD,IAAI,CAAC,CAAC,CAAC;IACxEH,MAAM,CAACE,EAAE,CAACd,UAAU,EAAE,MAAMI,OAAO,CAACQ,MAAM,CAAC,CAAC;EAC7C;AACD,CAAC,CAAC;AAAAK,OAAA,CAAAC,OAAA,GAAAjB,QAAA;AAAAkB,MAAA,CAAAF,OAAA,GAAAA,OAAA,CAAAC,OAAA"}